# Distance Calculator

REST-сервис для расчета расстояний между городами.

## Описание проекта

Этот веб-сервис позволяет рассчитывать расстояния между городами двумя способами:
1. "Crowflight" - расчет прямого расстояния между точками по координатам (по формуле расстояния на сфере)
2. "Distance Matrix" - поиск расстояния в таблице предварительно рассчитанных значений

## Технический стек

- Java 8+
- Maven
- MySQL
- Liquibase
- Hibernate
- JEE 8 (JAX-RS) / SpringBoot

## Структура базы данных

### Таблица `city`
- `id` - уникальный идентификатор
- `name` - название города
- `latitude` - широта
- `longitude` - долгота

### Таблица `distance`
- `id` - уникальный идентификатор
- `from_city_id` - город отправления (внешний ключ к таблице city)
- `to_city_id` - город назначения (внешний ключ к таблице city)
- `distance` - расстояние между городами

## API

### 1. Список городов
**GET /api/cities**

Возвращает список всех городов в базе данных.

**Пример ответа:**
```json
[
  {
    "id": 1,
    "name": "Москва"
  },
  {
    "id": 2,
    "name": "Санкт-Петербург"
  }
]
```

### 2. Расчет расстояния
**POST /api/calculate**

**Входные данные:**
```json
{
  "type": "CROWFLIGHT", // или "DISTANCE_MATRIX", или "ALL"
  "fromCity": 1,
  "toCity": 2
}
```

**Пример ответа:**
```json
{
  "results": [
    {
      "fromCity": "Москва",
      "toCity": "Санкт-Петербург",
      "distance": 634.88,
      "calculationType": "CROWFLIGHT"
    }
  ]
}
```

### 3. Загрузка данных
**POST /api/upload**

Принимает XML-файл с городами и расстояниями через multipart/form-data форму.

**Пример XML-файла:**
```xml

  
    
      Москва
      55.755826
      37.617300
    
    
      Санкт-Петербург
      59.939099
      30.315877
    
  
  
    
      Москва
      Санкт-Петербург
      634.88
    
  

```

## Настройка и запуск приложения

### Требования
- JDK 8 или выше
- Maven 3.6 или выше
- MySQL 5.7 или выше

### Настройка базы данных
1. Создайте базу данных MySQL с именем `distance-calculator`
2. Установите логин/пароль `root/root` или измените настройки в `src/main/resources/liquibase.properties`

### Запуск
1. Клонируйте репозиторий
2. Перейдите в корневую директорию проекта
3. Выполните миграции базы данных: `mvn liquibase:update`
4. Соберите проект: `mvn clean package`
5. Разверните WAR-файл в сервере приложений WildFly/Tomcat

## Дополнительная информация

Для расчета прямого расстояния ("Crowflight") используется формула расчета расстояния на сфере, учитывающая координаты (широта и долгота) городов.